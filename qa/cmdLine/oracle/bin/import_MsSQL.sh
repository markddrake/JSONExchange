source qa/cmdLine/bin/initialize.sh $1 $BASH_SOURCE[0] mssql import $YADAMU_TESTNAME
export YADAMU_PARSER="CLARINET"
export SCHEMA_VERSION=1
sqlplus $DB_USER/$DB_PWD@$DB_CONNECTION @$YADAMU_SQL_PATH/RECREATE_MSSQL_ALL.sql $YADAMU_LOG_PATH $SCHEMA_VERSION 
source $YADAMU_SCRIPT_PATH/import_operations_MsSQL.sh $YADAMU_IMPORT_MSSQL $SCHEMA_VERSION ""
source $YADAMU_SCRIPT_PATH/export_operations_MsSQL.sh $YADAMU_OUTPUT_PATH $SCHEMA_VERSION $SCHEMA_VERSION
export PRIOR_VERSION=$SCHEMA_VERSION
let "SCHEMA_VERSION+=1"
sqlplus $DB_USER/$DB_PWD@$DB_CONNECTION @$YADAMU_SQL_PATH/RECREATE_MSSQL_ALL.sql $YADAMU_LOG_PATH $SCHEMA_VERSION 
source $YADAMU_SCRIPT_PATH/import_operations_MsSQL.sh $YADAMU_OUTPUT_PATH $SCHEMA_VERSION $PRIOR_VERSION
sqlplus $DB_USER/$DB_PWD@$DB_CONNECTION @$YADAMU_SQL_PATH/COMPARE_MSSQL_ALL.sql $YADAMU_LOG_PATH $PRIOR_VERSION $SCHEMA_VERSION $YADAMU_PARSER $MODE
source $YADAMU_SCRIPT_PATH/export_operations_MsSQL.sh $YADAMU_OUTPUT_PATH $SCHEMA_VERSION $SCHEMA_VERSION
export SCHEMA_VERSION=1
export SCHEMA=ADVWRK
export SCHEMA_VERSION=1
export FILENAME=AdventureWorksALL
sqlplus $DB_USER/$DB_PWD@$DB_CONNECTION @$YADAMU_SQL_PATH/RECREATE_SCHEMA.sql $YADAMU_LOG_PATH $SCHEMA$SCHEMA_VERSION 
source $YADAMU_BIN/import.sh --RDBMS=$YADAMU_VENDOR USERID=$DB_USER/$DB_PWD@$DB_CONNECTION  FILE=$YADAMU_IMPORT_MSSQL/$FILENAME.json TO_USER=\"$SCHEMA$SCHEMA_VERSION\" MODE=$MODE LOG_FILE=$YADAMU_IMPORT_LOG  EXCEPTION_FOLDER=$YADAMU_LOG_PATH
source $YADAMU_BIN/export.sh --RDBMS=$YADAMU_VENDOR USERID=$DB_USER/$DB_PWD@$DB_CONNECTION  FILE=$YADAMU_OUTPUT_PATH/$FILENAME$SCHEMA_VERSION.json owner=\"$SCHEMA$SCHEMA_VERSION\" MODE=$MODE  LOG_FILE=$YADAMU_EXPORT_LOG  EXCEPTION_FOLDER=$YADAMU_LOG_PATH
export PRIOR_VERSION=$SCHEMA_VERSION
let "SCHEMA_VERSION+=1"
sqlplus $DB_USER/$DB_PWD@$DB_CONNECTION @$YADAMU_SQL_PATH/RECREATE_SCHEMA.sql $YADAMU_LOG_PATH $SCHEMA$SCHEMA_VERSION 
source $YADAMU_BIN/import.sh --RDBMS=$YADAMU_VENDOR USERID=$DB_USER/$DB_PWD@$DB_CONNECTION  FILE=$YADAMU_OUTPUT_PATH/$FILENAME$PRIOR_VERSION.json TO_USER=\"$SCHEMA$SCHEMA_VERSION\" MODE=$MODE LOG_FILE=$YADAMU_IMPORT_LOG  EXCEPTION_FOLDER=$YADAMU_LOG_PATH
sqlplus $DB_USER/$DB_PWD@$DB_CONNECTION @$YADAMU_SQL_PATH/COMPARE_SCHEMA.sql $YADAMU_LOG_PATH $SCHEMA $PRIOR_VERSION $SCHEMA_VERSION $YADAMU_PARSER $MODE
source $YADAMU_BIN/export.sh --RDBMS=$YADAMU_VENDOR USERID=$DB_USER/$DB_PWD@$DB_CONNECTION  FILE=$YADAMU_OUTPUT_PATH/$FILENAME$SCHEMA_VERSION.json owner=\"$SCHEMA$SCHEMA_VERSION\" MODE=$MODE  LOG_FILE=$YADAMU_EXPORT_LOG  EXCEPTION_FOLDER=$YADAMU_LOG_PATH
node $YADAMU_QA_JSPATH/compareFileSizes $YADAMU_LOG_PATH $YADAMU_IMPORT_MSSQL $YADAMU_OUTPUT_PATH
node --max_old_space_size=4096 $YADAMU_QA_JSPATH/compareArrayContent $YADAMU_LOG_PATH $YADAMU_IMPORT_MSSQL $YADAMU_OUTPUT_PATH false